{
  "hash": "a5e7ee6ee4243a591d7bba63f1d28de9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Enzymmatic indicators of liver damage based on sex, race/ethnicity, and alcohol use history\"\nauthor: \"Landon Power\"\ndate: last-modified\nformat: \n  html:\n    editor: visual\n    toc: true\n    toc_float: true\n    number-sections: true\n    embed-resources: true\n    date-format: iso\n    theme: paper\n---\n\n\n\n\n# Setup and Data Ingest\n\n## Setup\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(janitor)\nlibrary(knitr)\nlibrary(magrittr)\nlibrary(broom)\nlibrary(naniar)\nlibrary(patchwork)\nlibrary(modelsummary)\nlibrary(pwr)\nlibrary(haven) # Package to ingest SAS transport files for 2017-2020 Pre-pandemic NHANES data\nlibrary(Hmisc)\nlibrary(tidyverse)\n\nsource(\"data/Love-boost.R\")\n\ntheme_set(theme_light())  # or use theme_set(theme_bw())\nknitr::opts_chunk$set(comment=NA)\n```\n:::\n\n\n\n\n## Data Ingest\n\nI ingested the demographic raw data from the NHANES 2017-2020 Pre-Pandemic Demographic data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Initially save the data from the NHANES Pre-pandemic 2017-2020 SAS transport\n#demographic <- haven::read_xpt(\"data/P_DEMO.xpt\")\n\n#saveRDS(demographic, \"data/P_DEMO.Rds\")\n\n# Simply read the tibble after data are saved\ndemographic <- readRDS(\"data/P_DEMO.Rds\")\n```\n:::\n\n\n\n\nI ingested the standard biochemistry panel raw data from the NHANES 2017-2020 Pre-Pandemic Laboratory data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Initially save the data from the NHANES Pre-pandemic 2017-2020 SAS transport\n#biochem <- haven::read_xpt(\"data/P_BIOPRO.xpt\")\n\n#saveRDS(biochem, \"data/P_BIOPRO.Rds\")\n\n# Simply read the tibble after data are saved\nbiochem <- readRDS(\"data/P_BIOPRO.Rds\")\n```\n:::\n\n\n\n\nFinally, I ingested the Alcohol Use raw data from the NHANES 2017-2020 Pre-Pandemic Questionnaire data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Initially save the data from the NHANES Pre-pandemic 2017-2020 SAS transport\n#alcohol <- haven::read_xpt(\"data/P_ALQ.xpt\")\n\n#saveRDS(alcohol, \"data/P_ALQ.Rds\")\n\n# Simply read the tibble after data are saved\nalcohol <- readRDS(\"data/P_ALQ.Rds\")\n```\n:::\n\n\n\n\n# Cleaning the Data\n\nI then merged the NHANES files before cleaning and selecting my variables.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfull_uncleaned1 <- left_join(demographic, biochem, by = \"SEQN\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfull_uncleaned2 <- left_join(full_uncleaned1, alcohol, by = \"SEQN\")\n```\n:::\n\n\n\n\nThen I cleaned the variables and selected only the variables I will use in analysis. I first cleaned the names of all the variables in the `full_uncleaned2` dataset.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfull <- full_uncleaned2 %>%\n  clean_names() %>%\n  mutate(across(where(is_character), as_factor))\n```\n:::\n\n\n\n\nI then selected the variables I will analyze and refined the observations to include only subjects who:\n\n-   had a `ridstatr` value of 2, meaning they were both interviewed and examined (N = 14,300)\n\n-   had a `ridageyr` between 21 and 79 years old (N = 7,853)\n\nFor my analysis, I then filtered to the proper variables I will analyze:\n\n-   Analysis A: two quantitative variables\n\n    -   alanine aminotransferase (ALT, in U/L)\n\n    -   aspartate aminotransferase (AST, in U/L)\n\n-   Analysis B: outcome (ALT) and binary categorical variable (gender)\n\n-   Analysis C: outcome (ALT) and multi-categorical variable (Race/Hispanic origin)\n\n-   Analysis E: J x K table of two categorical variables\n\n    -   J (2-5 levels): Ever had 4/5 or more drinks every day? (4 levels, Yes/No/Refused/Don't Know)\n\n    -   K (3-5 levels): Race/Hispanic origin (5 levels)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliver_damage <- full %>%\n  filter(ridstatr == \"2\") %>%\n  filter(between(ridageyr, 21, 79)) %>%\n  select(seqn, ridstatr, ridageyr, lbxsatsi, lbxsassi, \n         riagendr, ridreth1, alq151) %>%\n  mutate(riagendr = fct_recode(factor(riagendr), \n                            \"male\" = \"1\", \n                            \"female\" = \"2\")) %>%\n  mutate(ridreth1 = fct_recode(factor(ridreth1), \n                            \"Mexican American\" = \"1\", \n                            \"Other Hispanic\" = \"2\",\n                            \"Non-Hispanic White\" = \"3\",\n                            \"Non-Hispanic Black\" = \"4\",\n                            \"Other/Multi-Racial\" = \"5\")) %>%\n  mutate(alq151 = fct_recode(factor(alq151), \n                            \"yes\" = \"1\", \n                            \"no\" = \"2\",\n                            \"Refused\" = \"7\",\n                            \"Don't Know\" = \"9\"))\n\nhead(liver_damage)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 8\n    seqn ridstatr ridageyr lbxsatsi lbxsassi riagendr ridreth1           alq151\n   <dbl>    <dbl>    <dbl>    <dbl>    <dbl> <fct>    <fct>              <fct> \n1 109266        2       29       15       14 female   Other/Multi-Racial no    \n2 109271        2       49        8       14 male     Non-Hispanic White yes   \n3 109273        2       36       35       27 male     Non-Hispanic White no    \n4 109274        2       68       19       20 male     Other/Multi-Racial no    \n5 109282        2       76       17       19 male     Non-Hispanic White no    \n6 109284        2       44       16       15 female   Mexican American   <NA>  \n```\n\n\n:::\n:::\n\n\n\n\n# Codebook and Data Description\n\n7853 adults ages 21-79 participating in the NHANES 2017-2020 with data on the variables listed below. The data will be filtered to the complete cases in each discrete analysis as it is completed.\n\n## Codebook\n\n| Variable | Type | Description |\n|:----------------------:|:----------------------:|:----------------------:|\n| **SEQN** | ID | Respondent sequence number |\n| **lbxsatsi** | Quant | Alanine aminotransferase (ALT; in U/L) |\n| **lbxsassi** | Quant | Aspartate aminotransferase (AST; in U/L) |\n| **riagendr** | Binary | Gender |\n| **ridreth1** | 5-Cat | Race/Hispanic origin (1 = Mexican American, 2 = Other Hispanic, 3 = Non-Hispanic White, 4 = Non-Hispanic Black, 5 = Other Race, Including Multi-Racial) |\n| **alq151** | Binary | Period of life where subject ever had more than 4/5 drinks every day? (1 = Yes, 2 = No, 7 = Refused, 9 = Don't know) |\n\n## Analytic Tibble\n\nThe complete tibble and a summary of the variables that are missing values is shown below.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliver_damage\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7,853 × 8\n     seqn ridstatr ridageyr lbxsatsi lbxsassi riagendr ridreth1           alq151\n    <dbl>    <dbl>    <dbl>    <dbl>    <dbl> <fct>    <fct>              <fct> \n 1 109266        2       29       15       14 female   Other/Multi-Racial no    \n 2 109271        2       49        8       14 male     Non-Hispanic White yes   \n 3 109273        2       36       35       27 male     Non-Hispanic White no    \n 4 109274        2       68       19       20 male     Other/Multi-Racial no    \n 5 109282        2       76       17       19 male     Non-Hispanic White no    \n 6 109284        2       44       16       15 female   Mexican American   <NA>  \n 7 109286        2       33       10       13 female   Other/Multi-Racial <NA>  \n 8 109290        2       68       19       18 female   Non-Hispanic Black no    \n 9 109291        2       42       11       25 female   Other/Multi-Racial <NA>  \n10 109292        2       58       21       18 male     Other Hispanic     no    \n# ℹ 7,843 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngg_miss_var(liver_damage)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmiss_var_summary(liver_damage)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 3\n  variable n_miss pct_miss\n  <chr>     <int>    <num>\n1 alq151     1149    14.6 \n2 lbxsassi    637     8.11\n3 lbxsatsi    606     7.72\n4 seqn          0     0   \n5 ridstatr      0     0   \n6 ridageyr      0     0   \n7 riagendr      0     0   \n8 ridreth1      0     0   \n```\n\n\n:::\n:::\n\n\n\n\n## Data Summary\n\n### Alanine aminotransferase (ALT; in U/L)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescribe(liver_damage$lbxsatsi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nliver_damage$lbxsatsi : Alanine Aminotransferase (ALT) (U/L) \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n    7247      606      146    0.999    22.59     14.8        9       10 \n     .25      .50      .75      .90      .95 \n      13       18       26       39       51 \n\nlowest :   2   3   4   5   6, highest: 208 211 213 338 682\n```\n\n\n:::\n:::\n\n\n\n\n### Aspartate aminotransferase (AST; in U/L)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescribe(liver_damage$lbxsassi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nliver_damage$lbxsassi : Aspartate Aminotransferase (AST) (U/L) \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n    7216      637      122    0.997    21.95    10.02    12.00    13.00 \n     .25      .50      .75      .90      .95 \n   16.00    19.00    24.00    31.00    38.25 \n\nlowest :   6   7   8   9  10, highest: 218 272 294 307 489\n```\n\n\n:::\n:::\n\n\n\n\n### Gender\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescribe(liver_damage$riagendr)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nliver_damage$riagendr \n       n  missing distinct \n    7853        0        2 \n                        \nValue        male female\nFrequency    3794   4059\nProportion  0.483  0.517\n```\n\n\n:::\n:::\n\n\n\n\n### Race/Hispanic origin\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescribe(liver_damage$ridreth1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nliver_damage$ridreth1 \n       n  missing distinct \n    7853        0        5 \n                                                                   \nValue        Mexican American     Other Hispanic Non-Hispanic White\nFrequency                 945                847               2491\nProportion              0.120              0.108              0.317\n                                                \nValue      Non-Hispanic Black Other/Multi-Racial\nFrequency                2179               1391\nProportion              0.277              0.177\n```\n\n\n:::\n:::\n\n\n\n\n### Period of life where subject ever had more than 4/5 drinks every day?\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescribe(liver_damage$alq151)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nliver_damage$alq151 \n       n  missing distinct \n    6704     1149        4 \n                                                      \nValue             yes         no    Refused Don't Know\nFrequency        1061       5633          1          9\nProportion      0.158      0.840      0.000      0.001\n```\n\n\n:::\n:::\n\n\n\n\n# Analysis A: Comparing 2 Means with Paired Samples\n\n## The Question\n\nTo find a good proxy for liver damage, I decided to compares the means of two quantitative variables from the NHANES 2017-2020 dataset. There were 7247 NHANES participants with complete ALT values and 7216 NHANES participants with complete AST values.\n\n**Question:** Since both elevated ALT and AST are indicators of liver damage and since these variables are collected on each of the participants and can be considered paired samples, do the means of these two enzymmatic markers of liver function closely approximate each other, such that they are not significantly different?\n\n**Expectation:** Both ALT and AST are functionally related enzymmatic markers, even though elevated ALT is more characteristic of liver damage. In this case, I expect there to be no significant difference between the means of alanine aminotransferase and aspartate aminotransferase values. If there is no significant difference, this would indicate that either of these variables could be used as a proxy for liver damage in future analysis.\n\n## Describing the Data\n\n### Variables\n\nThe variable `lbxsatsi` is the alanine aminotransferase (ALT; in U/L) level measured in the blood serum of the NHANES participants. The ALT level was recorded in units/liter. This enzyme is specific to the liver and and elevated serum ALT is an indicator of liver damage.\n\nThe variable `lbxsassi` is the aspartate aminotransferase (AST; in U/L) level measured in the blood serum of the NHANES participants. The AST was also recorded in units/liter. This enzyme is present in the liver, heart, brain, kidneys, and muscles, but is classically used as a less-specific marker of liver damage.\n\n### Numerical Summaries/Visualizations\n\n#### Visualization\n\nFirst, the data was visualized to observe whether there appeared to be an association between ALT and AST. The dataset was filtered to the complete cases that had recorded ALT and AST values for this analysis.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliver_damage_analA <- liver_damage %>%\n  filter(complete.cases(lbxsatsi, lbxsassi))\n\nliver_damage_analA %>%\n  ggplot(., aes(x = lbxsatsi, y = lbxsassi)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", col = \"red\",\n              se = TRUE, formula = y ~ x) +\n  theme(aspect.ratio = 1) +\n  labs(caption = \"Each subject had an ALT (in U/L) and AST (in U/L)\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n\nSince ALT and AST are paired by participant, we can calculate an additional variable, the difference between ALT and AST values to make a visual comparison of the difference between the two values more apparent. The difference in ALT and AST was calculated as ALT minus AST.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliver_damage_analA <- liver_damage_analA %>%\n  mutate(diff_ALT_AST = lbxsatsi - lbxsassi)\n```\n:::\n\n\n\n\nAfter calculating the difference in ALT and AST, I constructed a boxplot to visualize the distribution of the difference.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = liver_damage_analA, aes(x = diff_ALT_AST, y = \"\")) +\n  geom_violin(fill = \"dodgerblue\") +\n  geom_boxplot(width = 0.3, outlier.size = 3) +\n  stat_summary(fun = \"mean\", geom = \"point\",\n               shape = 23, size = 4, fill = \"blue\") +\n  labs(x = \"ALT - AST (difference in alanine and aspartate aminotransferase levels)\",\n       y = \"\", title = \"Distribution of Liver Enzyme Differences\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n\n#### Numerical Summaries\n\nWhile it appears that most of the differences in ALT and AST values lie close to zero, numerical summaries for each variable and the difference of ALT minus AST were calculated before the main analysis was completed.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsumm_anala <- as_tibble(bind_rows(\n  mosaic::favstats(~ lbxsatsi, data = liver_damage_analA),\n  mosaic::favstats(~ lbxsassi, data = liver_damage_analA),\n  mosaic::favstats(~ diff_ALT_AST, data = liver_damage_analA))) %>%\n  mutate(item = c(\"lbxsatsi\", \"lbxsassi\", \"diff_ALT_AST\")) %>%\n  select(item, n, mean, sd, min, median, max)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n```\n\n\n:::\n\n```{.r .cell-code}\nsumm_anala %>% kable()\n```\n\n::: {.cell-output-display}\n\n\n|item         |    n|      mean|       sd|  min| median| max|\n|:------------|----:|---------:|--------:|----:|------:|---:|\n|lbxsatsi     | 7216| 22.578575| 18.94270|    2|     18| 682|\n|lbxsassi     | 7216| 21.949279| 14.72411|    6|     19| 489|\n|diff_ALT_AST | 7216|  0.629296| 10.98709| -148|     -1| 193|\n\n\n:::\n:::\n\n\n\n\n## Main Analysis\n\nTo test my hypothesis that the mean of ALT and AST would not significantly differ from each other, I chose to conduct a bootstrapping procedure for the comparison of means. I used a bootstrap procedure rather than a paired t-test since the distribution of the difference in ALT and AST does not appear to be normally distributed. As shown in the figure, \"Distribution of Liver Enzyme Differences,\" above, there are a large number of values at the extreme ends of the distribution and the distribution may be slightly skewed to the right since the mean is slightly greater than the median. I set a random seed and used a confidence interval of 90%, with 2000 observations for the bootstrap procedure.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(431)\nliver_damage_analA %$% \n  Hmisc::smean.cl.boot(diff_ALT_AST, conf = 0.90, B = 2000) %>%\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n|      |    x|\n|:-----|----:|\n|Mean  | 0.63|\n|Lower | 0.42|\n|Upper | 0.85|\n\n\n:::\n:::\n\n\n\n\n## Conclusions\n\nBased on the result of the bootstrap procedure, it appears that the levels of alanine aminotransferase (ALT) are slightly higher than that of aspartate aminotransferase (AST) since the mean of the difference between ALT and AST is 0.63 and the 90% CI does not include zero.\n\nWhile my initial expectation was that these variables would closely approximate each other and that there would be no significant difference between their means, it does appear that the mean of ALT is slightly higher than that of AST. I think this may be due to the concept that I mentioned earlier that ALT is a more specific indicator of liver damage, and would be more likely to be elevated in a population, compared to AST. Further investigation with these two variables could look into whether there is a correlation between these liver enzymes and history of alcohol use in this NHANES population.\n\n# Analysis B: Comparing 2 Means with Independent Samples\n\n## The Question\n\nAfter considering a proxy for liver damage in the variable alanine aminotransferase (ALT), I decided to compares the means of ALT in two independent samples, males and females, from the NHANES 2017-2020 dataset. There were 7247 NHANES participants with complete ALT values and 7853 NHANES participants with complete gender information.\n\n**Question:** Considering that ALT can be used as an indicator for liver damage and since males and females can be considered two independent sampling groups, does the mean ALT level differ between males and females in the participants within the NHANES dataset, and can this be used to draw conclusions about liver damage in the population?\n\n**Expectation:** As ALT is a characteristic marker of liver damage and it seems to be anecdotally true that men are more likely to have problems with alcohol use and consumption, I expect the mean ALT in males to be higher than that of females. If true, this result would indicate a higher frequency of liver damage in males compared to females and could be extrapolated to draw conclusions about alcohol usage in future analysis.\n\n## Describing the Data\n\n### Variables\n\nThe variable `lbxsatsi` is the alanine aminotransferase (ALT; in U/L) level measured in the blood serum of the NHANES participants. The ALT level was recorded in units/liter. This enzyme is specific to the liver and and elevated serum ALT is an indicator of liver damage.\n\nThe variable `riagendr` is the binary variable (male or female) that records the sex of the NHANES participants.\n\n### Numerical Summaries/Visualizations\n\n#### Visualization\n\nThe dataset was filtered to the complete cases that had recorded ALT and gender values for this analysis. I then visualized the distribution of ALT in both males and females using a boxplot with the mean (blue diamond) and median with quartiles (white box of the boxplot).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliver_damage_analB <- liver_damage %>%\n  filter(complete.cases(lbxsatsi, riagendr))\n\nggplot(liver_damage_analB, aes(x = riagendr, y = lbxsatsi)) +\n  geom_violin(aes(fill = riagendr)) +\n  geom_boxplot(width = 0.3, outlier.size = 2, notch = T) +\n  stat_summary(fun = \"mean\", geom = \"point\",\n               shape = 23, size = 4, fill = \"blue\") +\n  guides(fill = \"none\") +\n  scale_fill_viridis_d(alpha = 0.3) + \n  coord_flip() +\n  labs(y = \"Alanine aminotransferase (ALT; in U/L)\",\n       x = \"\",\n       title = \"Comparing ALT Levels by Sex\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n\n#### Numerical Summaries\n\nWhile it appears that most of the ALT values are centered around 20, the distribution of ALT values in both males and females is strongly skewed right. Numerical summaries for ALT in males and females were calculated before the main analysis was completed.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaic::favstats(lbxsatsi ~ riagendr, data = liver_damage_analB)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  riagendr min   Q1 median Q3 max     mean       sd    n missing\n1     male   2 16.0     21 31 682 26.94158 22.60026 3492       0\n2   female   3 11.5     15 21 213 18.54274 13.50479 3755       0\n```\n\n\n:::\n:::\n\n\n\n\n## Main Analysis\n\nTo test my hypothesis that the mean of ALT would be higher in males than females, I chose to conduct a bootstrapping procedure for the comparison of means of two independent samples. I used a bootstrap procedure rather than a two-sample t-test or Welch's t-test since the distribution of ALT in both males and females is not normally distributed. As shown in the figure, \"Comparing ALT Levels by Sex,\" above, there is a long right-sided tail for ALT distributions in both males and females, indicating right-skewed distributions in both groups, which is further confirmed by the numerical summary above, since the mean ALT in both males and females is larger than the median ALT. I set a random seed and used a confidence interval of 90%, with 2000 observations for the bootstrap procedure.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(431)\nliver_damage_analB %$% bootdif(y = lbxsatsi, g = riagendr, conf.level = 0.90,\n                  B.reps = 2000) %>%\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n|                |     x|\n|:---------------|-----:|\n|Mean Difference | -8.40|\n|0.05            | -9.08|\n|0.95            | -7.69|\n\n\n:::\n:::\n\n\n\n\n## Conclusions\n\nThe results of the bootstrap procedure for comparison of two independent sample means indicates that the difference in means ($$ \\mu_{female} - \\mu_{male} $$), was -8.40. This result indicates that the ALT level in the male participants from the NHANES dataset was significantly higher than that of the ALT level in females, since the 90% CI of the difference in means (-9.08, -7.69) did not include 0. Therefore, I conclude that my expectation was confirmed and, within the NHANES data set, males have a significantly higher ALT level than females. This result may indicate that males in the NHANES data have a higher rate of liver damage. Future analysis could be conducted to determine whether this elevated ALT level is correlated with differences in alcohol use and alcohol history in males and females.\n\n# Analysis C: Comparing 5 Means with Independent Samples\n\n## The Question\n\nSince alanine aminotransferase (ALT) was elevated in males compared to females, I also wanted to compare the means of ALT across different racial and ethnic groups including, Mexican American, Other Hispanic, Non-Hispanic White, Non-Hispanic Black, Other Race, Including Multi-Racial, from the NHANES 2017-2020 dataset. There were 7247 NHANES participants with complete ALT values and 7853 NHANES participants with Race/Hispanic origin information.\n\n**Question:** Considering that ALT can be used as an indicator for liver damage and since each of these different racial/ethnic groups can be considered independent samples, does the mean ALT level differ between participants with different racial/Hispanic origin in the participants within the NHANES dataset, and can this be used to draw conclusions about liver damage in the population?\n\n**Expectation:** ALT is a characteristic marker of liver damage, and there is good evidence from the data of higher levels of ALT in males compared to females; however, I would not expect there to be significantly different levels of ALT in one racial category over another.\n\n## Describing the Data\n\n### Variables\n\nThe variable `lbxsatsi` is the alanine aminotransferase (ALT; in U/L) level measured in the blood serum of the NHANES participants. The ALT level was recorded in units/liter. This enzyme is specific to the liver and and elevated serum ALT is an indicator of liver damage.\n\nThe variable `ridreth1` is the 5-category variable (Mexican American, Other Hispanic, Non-Hispanic White, Non-Hispanic Black, Other Race, Including Multi-Racial) that records the Race/Hispanic origin of the NHANES participants.\n\n### Numerical Summaries/Visualizations\n\n#### Visualization\n\nThe dataset was filtered to the complete cases that had recorded ALT and Race/Hispanic origin values for this analysis. I then visualized the distribution of ALT in the five different race categories using a boxplot with the mean (blue diamond) and median with quartiles (white box of the boxplot).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliver_damage_analC <- liver_damage %>%\n  filter(complete.cases(lbxsatsi, ridreth1))\n\nggplot(liver_damage_analC, aes(x = ridreth1, y = lbxsatsi)) +\n  geom_violin(aes(fill = ridreth1)) +\n  geom_boxplot(width = 0.3, outlier.size = 2, notch = T) +\n  stat_summary(fun = \"mean\", geom = \"point\",\n               shape = 23, size = 4, fill = \"blue\") +\n  guides(fill = \"none\") +\n  scale_fill_viridis_d(alpha = 0.3) + \n  coord_flip() +\n  labs(y = \"Alanine aminotransferase (ALT; in U/L)\",\n       x = \"\",\n       title = \"Comparing ALT Levels by Race/Hispanic Origin\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n\n#### Numerical Summaries\n\nWhile it appears that most of the ALT values are centered around 20, the distribution of ALT values in all Race/Hispanic origin groups is strongly skewed right. Numerical summaries for ALT in each group were calculated before the main analysis was completed.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaic::favstats(lbxsatsi ~ ridreth1, data = liver_damage_analC)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            ridreth1 min Q1 median Q3 max     mean       sd    n missing\n1   Mexican American   7 15     21 31 211 26.40924 19.94386  909       0\n2     Other Hispanic   3 14     19 28 213 24.18159 19.35956  793       0\n3 Non-Hispanic White   3 13     18 26 338 22.70347 17.53764 2364       0\n4 Non-Hispanic Black   2 12     16 22 208 19.49581 14.77949 1910       0\n5 Other/Multi-Racial   4 13     18 26 682 23.30291 24.45282 1271       0\n```\n\n\n:::\n:::\n\n\n\n\n## Main Analysis\n\nTo test my hypothesis that there would be no significant difference in the mean of ALT among the different racial/Hispanic origin groups, I chose to conduct an analysis of variance with the Tukey HSD for pariwise comparisons. While the residuals among the different groups do not appear to be normally distributed, the ANOVA F test should still be relatively robust to the lack of normality. As shown in the figure, \"Comparing ALT Levels by Race/Hispanic Origin,\" above, there is a long right-sided tail for ALT distributions in both males and females, indicating right-skewed distributions in all the groups, which is further confirmed by the numerical summary above, since the mean ALT in all groups is larger than the median ALT. I used a CI of 90% in the Tukey HSD pairwise comparison.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_one <- lm(lbxsatsi ~ ridreth1, data = liver_damage_analC)\ntukey_one <- tidy(TukeyHSD(aov(model_one), \n                           ordered = TRUE, \n                           conf.level = 0.90))\ntukey_one %>% rename(null = null.value) %>% kable(dig = 3)\n```\n\n::: {.cell-output-display}\n\n\n|term     |contrast                              | null| estimate| conf.low| conf.high| adj.p.value|\n|:--------|:-------------------------------------|----:|--------:|--------:|---------:|-----------:|\n|ridreth1 |Non-Hispanic White-Non-Hispanic Black |    0|    3.208|    1.784|     4.631|       0.000|\n|ridreth1 |Other/Multi-Racial-Non-Hispanic Black |    0|    3.807|    2.132|     5.482|       0.000|\n|ridreth1 |Other Hispanic-Non-Hispanic Black     |    0|    4.686|    2.731|     6.640|       0.000|\n|ridreth1 |Mexican American-Non-Hispanic Black   |    0|    6.913|    5.049|     8.778|       0.000|\n|ridreth1 |Other/Multi-Racial-Non-Hispanic White |    0|    0.599|   -1.010|     2.209|       0.891|\n|ridreth1 |Other Hispanic-Non-Hispanic White     |    0|    1.478|   -0.420|     3.377|       0.309|\n|ridreth1 |Mexican American-Non-Hispanic White   |    0|    3.706|    1.900|     5.511|       0.000|\n|ridreth1 |Other Hispanic-Other/Multi-Racial     |    0|    0.879|   -1.215|     2.972|       0.840|\n|ridreth1 |Mexican American-Other/Multi-Racial   |    0|    3.106|    1.097|     5.116|       0.001|\n|ridreth1 |Mexican American-Other Hispanic       |    0|    2.228|   -0.020|     4.476|       0.105|\n\n\n:::\n:::\n\n\n\n\nThe following plot shows the results of the Tukey HSD for pairwise comparisons and the estimated effect for each pairwise comparison. This graph facilitates an easier interpretation of the pairwise comparisons with the largest effects.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tukey_one, aes(x = reorder(contrast, -estimate), \n                      y = estimate)) +\n  geom_pointrange(aes(ymin = conf.low, ymax = conf.high)) + \n  geom_hline(yintercept = 0, col = \"red\", \n             linetype = \"dashed\") +\n  geom_text(aes(label = round(estimate,2)), nudge_x = -0.2) +\n  labs(x = \"Contrast between Race/Hispanic Origin Groups\",\n       y = \"Estimated Effect, with 90% Tukey HSD interval\",\n       title = \"Estimated Effects, with Tukey HSD 90% Confidence Intervals\",\n       subtitle = \"Comparing ALT by Race/Hispanic Origin Group, NHANES 2017-2020 data\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  theme(axis.text.x = element_text(size = 7))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n\n## Conclusions\n\nThe Tukey HSD pairwise comparison demonstrated that there was a largest effects, which appeared to be significant, given the adjusted p-value of less than 0.05 at a 90% confidence interval for the pairwise comparisons between: Mexican American-Non-Hispanic Black, Other Hispanic-Non-Hispanic Black, Other/Multi-Racial-Non-Hispanic Black, Mexican American-Non-Hispanic White, Non-Hispanic White-Non-Hispanic Black, and Mexican-American-Other/Multi-Racial. The other effects were not significant. These results indicate that there are most likely differences in ALT levels between different racial/Hispanic origin groups, with the highest levels of ALT in the Mexican American and Other Hispanic groups. This finding will be important for future analysis and could be further explored to see whether there are correlations between higher ALT levels in these groups and patterns of more frequent alcohol consumption.\n\n# Analysis E: Analyzing a 2 x 5 Table\n\n## The Question\n\nBased on the previous analysis, I then wanted to compare the alcohol consumption habits among the different Race/Hispanic Origin groups defined by NHANES. From the Tukey HSD pairwise comparisons, alanine aminotransferase (ALT) appeared to have the largest effect in comparisons made with the Mexican American and Other Hispanic groups when they were compared with other Racial/Hispanic origin groups. From the apparent elevation in ALT levels in these two groups, I then decided to explore whether there is an association between periods of high alcohol consumption and Race/Hispanic Origin in these groups in questionnaire data from the NHANES 2017-2020 dataset. There were 7853 NHANES participants with Race/Hispanic origin information and 6704 NHANES participants with answers to the question of whether there has ever been a period in their life where they have had 4/5 or more drinks every day.\n\n**Question:** Considering that ALT can be used as an indicator for liver damage and the elevated ALT levels in Mexican American and Other Hispanic groups from the previous analysis, is there a significant association between Race/Hispanic Origin and having a period of high alcohol consumption in the participants within the NHANES dataset?\n\n**Expectation:** Based on the results from Analysis C, I expect that there is an association between the two variables of reporting a period of heavy alcohol consumption and Race/Hispanic Origin.\n\n## Describing the Data\n\n### Variables\n\nThe variable `ridreth1` is the 5-category variable (Mexican American, Other Hispanic, Non-Hispanic White, Non-Hispanic Black, Other Race, Including Multi-Racial) that records the Race/Hispanic origin of the NHANES participants.\n\nThe variable `alq151` is the binary variable that records periods of high alcohol consumption with the response to the question: \"Period of life where subject ever had more than 4/5 drinks every day?\" The responses of the NHANES participants were recorded, although a few answered \"Don't Know\" and one refused to answer.\n\n### Numerical Summaries/Visualizations\n\nThe data set was filtered to the complete cases that had recorded Race/Hispanic origin and Period of High Alcohol Consumption values for this analysis. I excluded the responses that were \"Don't Know\" or \"Refused\" for the Period of High Alcohol Consumption variable. Thus the data set has a total of 6694 observations for participants that responded to the Period of High Alcohol Consumption question.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliver_damage_analE <- liver_damage %>%\n  filter(complete.cases(ridreth1, alq151)) %>%\n  filter(alq151 == \"yes\" | alq151 == \"no\") %>%\n  droplevels(liver_damage$alq151)\n```\n:::\n\n\n\n\n#### Numerical Summaries\n\nBelow, I show the tabulation of the 4 by 5 table to summarize the responses within each Racial/Hispanic Origin group.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrosstab <- table(liver_damage_analE$ridreth1, liver_damage_analE$alq151)\ncrosstab\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    \n                      yes   no\n  Mexican American    133  685\n  Other Hispanic      108  608\n  Non-Hispanic White  424 1885\n  Non-Hispanic Black  292 1569\n  Other/Multi-Racial  104  886\n```\n\n\n:::\n:::\n\n\n\n\n#### Visualization\n\nI then visualized the cross-tabulation of the 4 by 5 table as a bar-plot in the five different race categories using a boxplot with the mean (blue diamond) and median with quartiles (white box of the boxplot).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(liver_damage_analE, aes(x = ridreth1, fill = alq151)) + \n  geom_bar(stat = \"count\", position = \"dodge\") + \n  labs(x = \"Race/Hispanic Origin\", y = \"Count\", fill = \"Period High Alcohol Consumption\") +\n  theme_minimal() +\n  ggtitle(\"Count of Period of High Alcohol Consumption by Race/Hispanic Origin\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  theme(axis.text.x = element_text(size = 7)) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n\n\n## Main Analysis\n\nTo test my hypothesis that there would be higher rates of Period of High Alcohol Consumption in the Mexican American and Other Hispanic groups, I conducted a Chi-squared test to calculate the association between Race/Hispanic Origin group and Period of High Alcohol Consumption.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(crosstab)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  crosstab\nX-squared = 32.59, df = 4, p-value = 1.449e-06\n```\n\n\n:::\n:::\n\n\n\n\n## Conclusions\n\nThe results of the Chi-squared test above result in a p-value that is much less than 0.05. Since there are more than five observations in each cell, I conclude that the Chi-squared test is an appropriate statistic to assess the possible association between Race/Hispanic Origin and Period of High Alcohol Consumption. Given that the p-value is 1.5x10^-6^ and is much less than 0.05, I conclude that I can reject the null hypothesis, that there is no association between Race/Hispanic Origin and Period of High Alcohol Consumption. This test statistic indicates that there is a significant association between these two variables. The Chi-squared statistic is also quite large compared to the Chi-square value needed to achieve significant at p \\< 0.05 with 4 degrees of freedom (X^2^ = 9.49), thus reinforcing our conclusion that there is a strong association between Race/Hispanic Origin and Period of High Alcohol Consumption. However, there would have to be further analysis to determine the nature of this association and define whether there are specific Race/Hispanic Origin groups that have higher rates of a Period of High Alcohol Consumption.\n\n# Session Information\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxfun::session_info()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sonoma 14.6.1\n\nLocale: en_US.UTF-8 / en_US.UTF-8 / en_US.UTF-8 / C / en_US.UTF-8 / en_US.UTF-8\n\nPackage version:\n  askpass_1.2.0       backports_1.5.0     base64enc_0.1-3    \n  bayestestR_0.14.0   bit_4.0.5           bit64_4.0.5        \n  blob_1.2.4          broom_1.0.6         bslib_0.8.0        \n  cachem_1.1.0        callr_3.7.6         cellranger_1.1.0   \n  checkmate_2.3.2     cli_3.6.3           clipr_0.8.0        \n  cluster_2.1.6       colorspace_2.1-1    compiler_4.4.1     \n  conflicted_1.2.0    cpp11_0.5.0         crayon_1.5.3       \n  curl_6.0.1          data.table_1.16.0   datawizard_0.12.3  \n  DBI_1.2.3           dbplyr_2.5.0        digest_0.6.37      \n  dplyr_1.1.4         dtplyr_1.3.1        evaluate_0.24.0    \n  fansi_1.0.6         farver_2.1.2        fastmap_1.2.0      \n  fontawesome_0.5.2   forcats_1.0.0       foreign_0.8-87     \n  Formula_1.2-5       fs_1.6.4            gargle_1.5.2       \n  generics_0.1.3      ggformula_0.12.0    ggplot2_3.5.1      \n  ggridges_0.5.6      glue_1.7.0          googledrive_2.1.1  \n  googlesheets4_1.1.1 graphics_4.4.1      grDevices_4.4.1    \n  grid_4.4.1          gridExtra_2.3       gtable_0.3.5       \n  haven_2.5.4         highr_0.11          Hmisc_5.1-3        \n  hms_1.1.3           htmlTable_2.4.3     htmltools_0.5.8.1  \n  htmlwidgets_1.6.4   httr_1.4.7          ids_1.0.1          \n  insight_0.20.4      isoband_0.2.7       janitor_2.2.0      \n  jquerylib_0.1.4     jsonlite_1.8.8      knitr_1.48         \n  labeling_0.4.3      labelled_2.13.0     lattice_0.22-6     \n  lifecycle_1.0.4     lubridate_1.9.3     magrittr_2.0.3     \n  MASS_7.3-61         Matrix_1.7-0        memoise_2.0.1      \n  methods_4.4.1       mgcv_1.9-1          mime_0.12          \n  modelr_0.1.11       modelsummary_2.2.0  mosaic_1.9.1       \n  mosaicCore_0.9.4.0  mosaicData_0.20.4   munsell_0.5.1      \n  naniar_1.1.0        nlme_3.1-166        nnet_7.3-19        \n  norm_1.0.11.1       openssl_2.2.1       parameters_0.22.2  \n  patchwork_1.2.0     performance_0.12.3  pillar_1.9.0       \n  pkgconfig_2.0.3     plyr_1.8.9          prettyunits_1.2.0  \n  processx_3.8.4      progress_1.2.3      ps_1.7.7           \n  purrr_1.0.2         pwr_1.3-0           R6_2.5.1           \n  ragg_1.3.2          rappdirs_0.3.3      RColorBrewer_1.1.3 \n  Rcpp_1.0.13         readr_2.1.5         readxl_1.4.3       \n  rematch_2.0.0       rematch2_2.1.2      reprex_2.1.1       \n  rlang_1.1.4         rmarkdown_2.28      rpart_4.1.23       \n  rstudioapi_0.16.0   rvest_1.0.4         sass_0.4.9         \n  scales_1.3.0        selectr_0.4.2       snakecase_0.11.1   \n  splines_4.4.1       stats_4.4.1         stringi_1.8.4      \n  stringr_1.5.1       sys_3.4.2           systemfonts_1.1.0  \n  tables_0.9.31       textshaping_0.4.0   tibble_3.2.1       \n  tidyr_1.3.1         tidyselect_1.2.1    tidyverse_2.0.0    \n  timechange_0.3.0    tinytable_0.4.0     tinytex_0.52       \n  tools_4.4.1         tzdb_0.4.0          UpSetR_1.4.0       \n  utf8_1.2.4          utils_4.4.1         uuid_1.2.1         \n  vctrs_0.6.5         viridis_0.6.5       viridisLite_0.4.2  \n  visdat_0.6.0        vroom_1.6.5         withr_3.0.1        \n  xfun_0.47           xml2_1.3.6          yaml_2.3.10        \n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}